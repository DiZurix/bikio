//Importation des libraries

#include <Adafruit_GFX.h>
#include <Adafruit_SSD1306.h>

#define OLED_RESET 4

Adafruit_SSD1306 display(OLED_RESET);

#if (SSD1306_LCDHEIGHT != 64)
#endif
const unsigned char logo[] PROGMEM = {  //Logo BIKIO en version en hexadécimal
    0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
    0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
    0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
    0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
    0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
    0xff, 0xff, 0xfc, 0x03, 0xfe, 0x03, 0xfc, 0xff, 0xf3, 0xe0, 0x3f, 0xfe, 0x00, 0xff, 0xff, 0xff,
    0xff, 0xff, 0xfc, 0x03, 0xfe, 0x03, 0xfc, 0xff, 0xf3, 0xe0, 0x3f, 0xfe, 0x00, 0xff, 0xff, 0xff,
    0xff, 0xff, 0xe7, 0xfe, 0x7f, 0x9f, 0xfc, 0xff, 0xf3, 0xf9, 0xff, 0xf9, 0xff, 0x3f, 0xff, 0xff,
    0xff, 0xff, 0xe7, 0xfe, 0x7f, 0x9f, 0xfc, 0xff, 0xf3, 0xf9, 0xff, 0xf9, 0xff, 0x3f, 0xff, 0xff,
    0xff, 0xff, 0xe7, 0xfe, 0x7f, 0x9f, 0xfc, 0xff, 0xdf, 0xf9, 0xff, 0xef, 0xff, 0xcf, 0xff, 0xff,
    0xff, 0xff, 0xe7, 0xfe, 0x7f, 0x9f, 0xfc, 0xff, 0xcf, 0xf9, 0xff, 0xcf, 0xff, 0xcf, 0xff, 0xff,
    0xff, 0xff, 0xe7, 0xfe, 0x7f, 0x9f, 0xfc, 0xff, 0xff, 0xf9, 0xff, 0xcf, 0xff, 0xcf, 0xff, 0xff,
    0xff, 0xff, 0xe7, 0xfe, 0x7f, 0x9f, 0xfc, 0xfe, 0x7f, 0xf9, 0xff, 0xcf, 0xff, 0xcf, 0xff, 0xff,
    0xff, 0xff, 0xe7, 0xfe, 0xff, 0x9f, 0xfc, 0xff, 0x7f, 0xf9, 0xff, 0xcf, 0xff, 0xcf, 0xff, 0xff,
    0xff, 0xff, 0xe0, 0x03, 0xff, 0x9f, 0xfc, 0xe1, 0xff, 0xf9, 0xff, 0xcf, 0xff, 0xcf, 0xff, 0xff,
    0xff, 0xff, 0xe0, 0x03, 0xff, 0x9f, 0xfc, 0xe1, 0xff, 0xf9, 0xff, 0xcf, 0xff, 0xcf, 0xff, 0xff,
    0xff, 0xff, 0xe7, 0xfe, 0x7f, 0x9f, 0xfc, 0xfe, 0x7f, 0xf9, 0xff, 0xcf, 0xff, 0xcf, 0xff, 0xff,
    0xff, 0xff, 0xe7, 0xfe, 0x7f, 0x9f, 0xfc, 0xfe, 0x7f, 0xf9, 0xff, 0xcf, 0xff, 0xcf, 0xff, 0xff,
    0xff, 0xff, 0xe7, 0xfe, 0x7f, 0x9f, 0xfc, 0xff, 0xdf, 0xf9, 0xff, 0xcf, 0xff, 0xcf, 0xff, 0xff,
    0xff, 0xff, 0xe7, 0xfe, 0x7f, 0x9f, 0xfc, 0xff, 0xcf, 0xf9, 0xff, 0xcf, 0xff, 0xcf, 0xff, 0xff,
    0xff, 0xff, 0xe7, 0xfe, 0x7f, 0x9f, 0xfc, 0xff, 0xff, 0xf9, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
    0xff, 0xff, 0xe7, 0xfe, 0x7f, 0x9f, 0xfc, 0xff, 0xf3, 0xf9, 0xff, 0xf9, 0xff, 0x3f, 0xff, 0xff,
    0xff, 0xff, 0xf7, 0xfe, 0xff, 0x9f, 0xfc, 0xff, 0xf3, 0xf9, 0xff, 0xfb, 0xff, 0x3f, 0xff, 0xff,
    0xff, 0xff, 0xfc, 0x03, 0xfe, 0x03, 0xfc, 0xff, 0xf3, 0xe0, 0x3f, 0xfe, 0x00, 0xff, 0xff, 0xff,
    0xff, 0xff, 0xfc, 0x03, 0xfe, 0x03, 0xfc, 0xff, 0xf3, 0xe0, 0x3f, 0xfe, 0x00, 0xff, 0xff, 0xff,
    0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
    0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
    0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
    0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
    0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
    0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
    0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff};

int lcd_logo() {    //On définit une fonction qui va afficher le logo
    display.begin(SSD1306_SWITCHCAPVCC, 0x3C); //Initialisation de l'affichage LCD
    display.clearDisplay(); //On supprime l'ancien affichage présent sur l'afficheur LCD
    display.drawBitmap(0, 0, logo, 128, 64, WHITE); //On convertit l'héxadecimal sous forme de pixel
    display.display(); //On affiche le logo convertit précédemment
}

int resize_txt(const char* text) { //On définit une fonction qui va permettre de recentrer le texte entrée dans notre LCD
    return (128/2 - (strlen(text)+1)*3); 
    /*Notre écran LCD fait 128 pixels de largeur, donc on prend la moitié et on récupère la taille du texte qu'on va
    multiplier par trois et soustraire les deux valeurs ensemble*/
}

int lcd_txt(int status) { //On définit une fonction qui va afficher du texte sur notre LCD
    char* text1;
    char* text2;
    char* text3;
    if (status == 0){ //Si la carte RFID a été detecté
        text1 = "Bienvenue";
        text2 = "{user}";
        text3 = "a Bikio";
    }
    else { //Si la carte RFID est inconnu.
        text1 = "Impossible de lire";
        text2 = "le block demande.";
        text3 = "Essayez une autre carte";
    }
    display.clearDisplay(); //On supprime l'ancien affichage présent sur l'afficheur LCD
    display.setTextColor(WHITE);    //On définit la couleur du texte en blanc
    display.setTextSize(1);     //On définit la taille du texte à 1.
    display.setCursor(resize_txt(text1), 0); //On se place au centre en haut de notre afficheur LCD
    display.println(text1);    //On affiche le texte de bienvenue
    display.setCursor(resize_txt(text2), 12);    //On se place au centre de notre afficheur LCD
    display.println(text2); //On affiche le nom de l'utilisateur
    display.setCursor(resize_txt(text3), 24);    //On se place au centre en bas de notre afficheur LCD
    display.println(text3); //On affiche la fin du message
    display.display();  //On affiche tout dans le lecteur LCD
}